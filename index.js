(function(){"use strict";var T="";function a(e,t,s,r,l,f,_,U){var i=typeof e=="function"?e.options:e;t&&(i.render=t,i.staticRenderFns=s,i._compiled=!0),r&&(i.functional=!0),f&&(i._scopeId="data-v-"+f);var n;if(_?(n=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(o=__VUE_SSR_CONTEXT__),l&&l.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(_)},i._ssrRegister=n):l&&(n=U?function(){l.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:l),n)if(i.functional){i._injectStyles=n;var S=i.render;i.render=function(O,c){return n.call(c),S(O,c)}}else{var p=i.beforeCreate;i.beforeCreate=p?[].concat(p,n):[n]}return{exports:e,options:i}}const h={extends:"k-files-field",computed:{buttons(){const e=this.$options.extends.options.computed.buttons.call(this);return e.push({icon:"url",text:this.$t("url"),responsive:!0,click:()=>this.$panel.dialog.open({component:"k-filesfromurl-dialog",props:{uploadinfo:this.uploadinfo},on:{uploaded:t=>this.uploaded(t)}})}),e},uploadinfo(){var e;return{endpoint:this.endpoints.field,parent:this.parent,fieldinfo:JSON.stringify({image:this.image,info:(e=this.info)!=null?e:!1,model:this.model,text:this.text}),...this.uploads}}},methods:{uploaded(e){this.multiple===!1&&(this.selected=[]),this.selected.push(e),this.onInput(),this.$events.emit("file.upload"),this.$events.emit("model.update")}}};let m,v;const u={};var g=a(h,m,v,!1,$,null,null,null);function $(e){for(let t in u)this[t]=u[t]}var b=function(){return g.exports}(),k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("k-dialog",e._b({staticClass:"k-filesfromurl-dialog",attrs:{"submit-button":e.$t("upload"),disabled:e.loading,theme:"positive",size:"medium",icon:"upload"},on:{submit:e.submit,cancel:function(r){return e.close()}}},"k-dialog",e.$props,!1),[s("k-url-field",{attrs:{theme:"field",name:"url",label:e.$t("url")},model:{value:e.url,callback:function(r){e.url=r},expression:"url"}}),e.error?s("k-box",{attrs:{theme:"negative",icon:"alert",text:e.error}}):e._e(),e.loading?s("k-box",{attrs:{theme:"info",icon:"loader",text:e.$t("upload")}}):e._e()],1)},F=[],w="";const C={extends:"k-dialog",props:{uploadinfo:{type:[Object],required:!0}},data(){return{url:"",error:!1,loading:!1}},methods:{submit(){const e="uploadfromurl";this.loading=!0,this.error=!1,this.$api.get(e,{url:this.url,...this.uploadinfo}).then(t=>{this.loading=!1,this.$emit("uploaded",t),this.close()}).catch(t=>{this.loading=!1,this.error=t.message})}}},d={};var x=a(C,k,F,!1,y,null,null,null);function y(e){for(let t in d)this[t]=d[t]}var R=function(){return x.exports}();window.panel.plugin("microman/filesfromurl",{fields:{files:b},components:{"k-filesfromurl-dialog":R}})})();
